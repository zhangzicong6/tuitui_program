;(function(){var Context=function(){"use strict";var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var s=function(){return(s=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function a(i,a,s,c){return new(s||(s=Promise))(function(t,e){function n(t){try{r(c.next(t))}catch(t){e(t)}}function o(t){try{r(c.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,o)}r((c=c.apply(i,a||[])).next())})}function c(n,o){var r,i,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,i=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=o.call(n,s)}catch(t){e=[6,t],i=0}finally{r=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var t=["joke_essay","Joke"],e=["live_stream"],n=["aweme"],r=["News","NewsSocial","Explore","NewsArticle","NewsInHouse","Video","VideoInHouse","VideoArticle","aweme","open_news"].concat(t,e,["Video","VideoInHouse","VideoArticle"],n,["open_news","TTAD"]),i=navigator.userAgent,u=new RegExp("("+r.join("|")+")","i"),p=new RegExp("("+t.join("|")+")","i"),l=new RegExp("("+e.join("|")+")","i"),f=new RegExp("("+n.join("|")+")","i"),d=(new RegExp("("+["NewsArticle"].join("|")+")","i"),new RegExp("("+["TTAD"].join("|")+")","i")),h=function(){return"http://nativeapp.toutiao.com"==document.referrer||u.test(i)},v=function(){return l.test(i)},g=function(){return f.test(i)},_=function(){return/windows phone/i.test(i)?"Windows Phone":/android/i.test(i)?"android":/iPad|iPhone|iPod/.test(i)&&!window.MSStream?"ios":"pc"},y=function(){return"android"===_()};function w(t,e){window.sessionStorage.setItem(t,e)}function m(t){return window.sessionStorage.getItem(t)}function b(t){if(t.sourceIndex)return t.sourceIndex-t.parentNode.sourceIndex-1;for(var e=0;t=t.previousElementSibling;)e++;return e}var I=function(t){var e,n;if(t)return{xpath:function(t){for(var e="";t.length;){var n=Array.prototype.pop.apply(t);if(n&&n.tagName&&"body"!=n.tagName.toLowerCase()&&"html"!=n.tagName.toLowerCase()){var o="function"==typeof n.getAttribute?n.getAttribute("id"):"";e+=n.tagName.toLowerCase()+b(n)+(o?"#"+o:"")+(0==t.length?"":">")}}return e}(((n=function(t){for(var e=[];t;)(t=t.parentNode)&&e.push(t);return e}(e=t)).unshift(e),n))}},S=function(){return{path:location.pathname,referrer:document.referrer,search:location.search,title:document.title||"",page_url:location.href,page_type:window._page_type?window._page_type:0,site_id:(t=window.location.pathname,(t.match(/\d+/g)||[])[0]||""||"")};var t};function k(t){var e=[];t=t||{};var n=/^(?:string|boolean|number)/i;for(var o in t)t.hasOwnProperty(o)&&n.test(typeof t[o])&&e.push(o+"="+t[o]);return e.join("&")}function x(t,e){var n=RegExp("[?&]"+t+"=([^&]*)").exec(e);return n&&decodeURIComponent(n[1].replace(/\+/g," "))}function L(t){var e=location.search;return x(t,e)||(e=document.referrer),x(t,e)}var C=0,E=1,R=2,A=function(){function t(t){this.adInfoFlag=E,this.appInfoFlag=E,this.bridgeLoaded=function(t){var n=document.createElement("script");n.src=t;var e=new Promise(function(t,e){n.onload=t,n.onerror=e});return document.head.appendChild(n),e}(t).then(function(){return self.ToutiaoJSBridge}),this.adInfo=this.callPromise("adInfo"),this.appInfo=this.callPromise("appInfo"),this.setSession()}return t.prototype.setBridgeState=function(t,e){switch(t){case"adInfo":this.adInfoFlag=e;break;case"appInfo":this.appInfoFlag=e}},t.prototype.callPromise=function(i){return a(this,void 0,void 0,function(){var o,r;return c(this,function(t){switch(t.label){case 0:return[4,(o=this).bridgeLoaded];case 1:return r=t.sent(),this.setBridgeState(i,C),[2,this.retry(function(){return new Promise(function(e,t){var n=setTimeout(function(){o.adInfoFlag!=C&&o.appInfoFlag!=C||t("timeout")},400);r.call(i,{},function(t){o.setBridgeState(i,R),e(t),clearTimeout(n)})})},1)]}})})},t.prototype.retry=function(o,r){void 0===r&&(r=1);var i=this;return new Promise(function(n){o().then(function(t){n(t)},function(){return a(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:if(1!==r)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),e=n,[4,o()];case 2:return e.apply(void 0,[t.sent()]),[3,4];case 3:return t.sent(),n({}),[3,4];case 4:return[3,6];case 5:n(i.retry(o,r-1)),t.label=6;case 6:return[2]}})})})})},t.prototype.track_event=function(e){return a(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.bridgeLoaded];case 1:return t.sent().call("track_event",e),[2]}})})},t.prototype.setSession=function(){return a(this,void 0,void 0,function(){var e,n;return c(this,function(t){switch(t.label){case 0:return n=[{}],[4,this.adInfo];case 1:return n=n.concat([t.sent()]),[4,this.appInfo];case 2:return e=s.apply(void 0,n.concat([t.sent()])),w("bridge",JSON.stringify(e)),[2]}})})},t}(),P=function(){var e,t=m("umeng")||"{}";try{e=JSON.parse(t)}catch(t){e={}}return e},M=0,N=2,O=1;"{}"!==JSON.stringify(P())&&(O=N);var U=function(){O=M;var t,e=decodeURIComponent(L("_toutiao_params")||L("_toutiao_recommend")||"");try{t=JSON.parse(e)}catch(t){return{}}return O=N,w("umeng",JSON.stringify(t)),t}(),D=O,j=new A("https://s3.pstatp.com/inapp/toutiao.js"),J=0,T=2,H=!h()&&/(UCBrowser|baiduboxapp|baidubrowser|MQQBrowser|QQ|MicroMessenger|Weibo|Opera|Firefox|MSIE|360SE|MetaSr|TheWorld|Firefox|LBBROWSER|Chrome|Safari)(\s|\/|_)(\S)/i.test(navigator.userAgent)?J:T;var F=function(){return a(this,void 0,void 0,function(){var e,n,o,r,i,a;return c(this,function(t){switch(t.label){case 0:return n=[{}],[4,j.adInfo];case 1:return n=n.concat([t.sent()]),[4,j.appInfo];case 2:return e=s.apply(void 0,n.concat([t.sent()])),o=100+10*j.adInfoFlag+j.appInfoFlag,r=1e3+100*j.adInfoFlag+10*D+H,i=s({},S(),P(),U,function(){var e,t=m("bridge")||"{}";try{e=JSON.parse(t)}catch(t){e={}}return e}(),e),a=JSON.parse(i.log_extra||"{}"),[2,{value:i.cid||"",log_extra:i.log_extra||"",req_id:i.req_id||a.req_id||"",cid:i.cid||"",ad_id:i.ad_id||L("_tt_ad_id")||L("ad_id")||"",device_id:i.device_id||"",user_id:i.user_id||"",uid:i.uid||"",ut:i.ut||"",app_version:i.appVersion||"",version_code:i.version_code||"",app_id:i.aid||"",os:_(),page_url:i.page_url,page_type:i.page_type,site_id:i.site_id,tt_bridge:o,tt_env:r}]}})})},B=(function(){function t(){}t.prototype.handleLog=function(t,e){return{log:t,context:e}}}(),function(){function t(t){this.API_URL=t}t.prototype.handleLog=function(t,e){try{var n=s({},e,t,{source:"webunion"});navigator.sendBeacon(this.API_URL,JSON.stringify(n))}catch(t){}}}(),function(){function t(){}t.prototype.handleLog=function(){}}(),function(){function t(){}return t.prototype.handleLog=function(t,e){var n="bytedance://"+(p.test(i)||y()||v()||g()?"log_event":"custom_event")+"?";this.isRealtimeReport(e.app_version)&&(n+="&realtime_report=1"),"ios"===_()?n+=this.formatData(s({},e,t)):n+=this.formatData(this.androidData(s({},e,t)));try{window.webkit.messageHandlers.observe.postMessage(n)}catch(t){console.log(n)}},t.prototype.formatData=function(t){var e="";for(var n in t)"object"==typeof t[n]?e+="&"+n+"="+encodeURIComponent(JSON.stringify(t[n])):e+="&"+n+"="+encodeURIComponent(t[n]);return e},t.prototype.androidData=function(t){return{category:t.category,tag:t.tag,label:t.label,value:t.cid,extra:t}},t.prototype.isRealtimeReport=function(t){return"6.6.7"===t},t}());!function(){function t(t){this.API_URL=t}t.prototype.handleLog=function(t,e){var n,o,r=(o=e,{convert_id:(n=t).convert_id||0,event_type:n.event_type||"",log_extra:o.log_extra,os:o.os,page_url:location.href,page_type:o.page_type}),i=s({track_data:encodeURIComponent(JSON.stringify([r]))},e),a=this.API_URL+"?"+k(i);try{(new Image).src=window.location.protocol+a+"&t="+new Date}catch(t){}}}();var V=function(){function t(){}return t.prototype.handleLog=function(t,e){var n="bytedance://log_event?",o=s({},e,t);for(var r in o)"object"==typeof o[r]?n+="&"+r+"="+encodeURIComponent(JSON.stringify(o[r])):n+="&"+r+"="+encodeURIComponent(o[r]);try{window.webkit.messageHandlers.observe.postMessage(n)}catch(t){console.log(n)}},t}();var $,q,Q=function(){function t(t){this.API_URL=t}return t.prototype.handleLog=function(t,e){var n,o,r=(o=e,{convert_id:(n=t).convert_id||0,event_type:n.event_type||"",log_extra:o.log_extra,os:o.os,page_url:location.href,page_type:o.page_type,xpath:n.xpath||"",select_content:n.select_content||"",event_value:n.event_value||""}),i=s({track_data:encodeURIComponent(JSON.stringify([r]))},e),a=this.API_URL+"?"+k(i);try{!function t(e,n){var o=n||0,r=new XMLHttpRequest;r.open("GET",e.url,!1),r.withCredentials=!0,r.onreadystatechange=function(){4===r.readyState&&200!==r.status&&o<1&&t(e,++o)},r.send(null)}({url:window.location.protocol+a+"&t="+new Date})}catch(t){}},t}(),W={category:"umeng",tag:"embeded_ad",label:"convert"},X={sdk_version:"0.0.1"},Y=function(){function t(){this.httpHandler=new Q("//isub.snssdk.com/2/wap/landing_tetris_log/"),this.iframeHandler=new V,this.consoleHandler=new B}return t.prototype.handleLog=function(t,e){if(t=s({},X,t),(!h()||this.isAwemeCompatible(e.app_version)||this.isLiveCompatible(e.app_version))&&(t.select_content&&(t.select_content=encodeURIComponent(t.select_content)),this.httpHandler.handleLog(t,e)),h())return t=s({},W,t),d.test(i)?this.iframeHandler.handleLog(t,e):this.consoleHandler.handleLog(t,e)},t.prototype.isAwemeCompatible=function(t){var e=!1;try{e=g()&&"ios"==_()&&parseInt(t.replace(/\./g,""))<182}catch(t){}return e},t.prototype.isLiveCompatible=function(t){var e=!1;try{e=v()&&"ios"==_()&&parseInt(t.replace(/\./g,""))<420}catch(t){}return e},t}(),G=["","webkit","Moz","MS","ms","o"],z=window,K=void 0!==function(t,e){var n,o,r=e[0].toUpperCase()+e.slice(1),i=0;for(;i<G.length;){if((o=(n=G[i])?n+r:e)in t)return t[o];i++}return}(z,"PointerEvent"),Z="ontouchstart"in z;(q=$||($={}))[q.Default=0]="Default",q[q.Start=1]="Start",q[q.Move=2]="Move",q[q.End=4]="End",q[q.Cancle=8]="Cancle";var tt={pointer:{events:["pointerdown","pointermove","pointerup","pointercancel"],handler:function(t){var e=t.type,n={status:$.Default,timestamp:Date.now(),position:[t.clientX,t.clientY]};return e!==this.events[0]||0!==t.button&&"touch"!==t.pointerType?e===this.events[1]?n.status=$.Move:e===this.events[2]?n.status=$.End:e===this.events[3]&&(n.status=$.Cancle):n.status=$.Start,n}},touch:{events:["touchstart","touchmove","touchend","touchcancel"],handler:function(t){var e=t.type;if(1!==t.changedTouches.length)return null;var n={status:$.Default,timestamp:Date.now(),position:[t.changedTouches[0].clientX,t.changedTouches[0].clientY]};return e===this.events[0]?n.status=$.Start:e===this.events[1]?n.status=$.Move:e===this.events[2]?n.status=$.End:e===this.events[3]&&(n.status=$.Cancle),n.status===$.Default?null:n}},mouse:{events:["mousedown","mousemove","mouseup"],handler:function(t){var e=t.type,n={status:$.Default,timestamp:Date.now(),position:[t.clientX,t.clientY]};return e===this.events[0]&&0===t.button?n.status=$.Start:e===this.events[1]?n.status=$.Move:e===this.events[2]&&(n.status=$.End),n.status&$.Move&&1!==t.which&&(n.status=$.End),n.status===$.Default?null:n}}};"MSPointerEvent"in z&&!("PointerEvent"in z)&&(tt.pointer.events=["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerCancel"]);var et=250,nt=9;function ot(t,e,n){for(var o=0;o<t.length;o++)document.addEventListener(t[o],e,n)}var rt={addClickEvent:function(a,t){var e=function(n){var o,r,i;return function(t){var e=tt[n].handler(t);if(null!==e){if(e.status&$.Start)return o=$.Start,r=e.timestamp,void(i=e.position);if(e.status&$.End)o&$.Start&&e.timestamp-r<et&&Math.sqrt(Math.pow(e.position[0]-i[0],2)+Math.pow(e.position[1]-i[1],2))<nt&&a(t);else if(e.status&$.Move&&o&$.Start)return}i=[r=o=0,0]}};K?ot(tt.pointer.events,e("pointer"),t):Z?ot(tt.touch.events,e("touch"),t):ot(tt.mouse.events,e("mouse"),t)}};var it,at=(function(t){function n(t){if(t)return function(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}(t)}(t.exports=n).prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,o=this._callbacks["$"+t];if(!o)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r=0;r<o.length;r++)if((n=o[r])===e||n.fn===e){o.splice(r,1);break}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n)for(var o=0,r=(n=n.slice(0)).length;o<r;++o)n[o].apply(this,e);return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}}(it={exports:{}},it.exports),it.exports),st=new Y,ct=function(e){function t(t){var r=e.call(this)||this;return r._invoke=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];r[t]&&(e=r[t]).call.apply(e,[r].concat(n))},r._init(t),r}return function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,e),t.prototype._init=function(t){for(;t.length;){var e=t.pop(),n=e[0],o=e.slice(1);this._invoke.apply(this,[n].concat(o))}},t.prototype.sendLog=function(n){return a(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return[4,F()];case 1:return e=t.sent(),st.handleLog(n,e),[2]}})})},t.prototype._get_basedata=function(){return a(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,F()];case 1:return[2,t.sent()]}})})},t.prototype.track=function(t,e){if("string"==typeof t){var n={event_type:t};e&&e.convert_id&&(n.convert_id=e.convert_id),this.sendLog(n),this.emit("track",n)}else console.log("event_type type error")},t}(at);return function(){if(!window.meteor._invoke){window.meteor._invoke=!0;var a,t,e=(window.meteor||[]).slice(),n=new ct(e);window.meteor=n,null!==(t=document.getElementById("_tt_real_page_url")||null)&&(a=t.getAttribute("href")||""),rt.addClickEvent(function(t){for(var e=t.target,n=e;e!=document;)"function"==typeof e.hasAttribute&&e.hasAttribute("tt-data-click")&&(o=e,r=void 0,(r={}).page_url=a||decodeURIComponent(location.href),r.event_type=o.getAttribute("tt-data-eventtype")||"",r.convert_id=o.getAttribute("tt-data-convertid")||"",r.event_value=o.getAttribute("tt-data-eventvalue")||"",r.target=o,r.options=o.getAttribute("tt-data-options")||"",window.meteor.track(s({},r,I(o)))),e=e.parentNode;var o,r;if(e==document&&window._xpath_config){var i={};i.target=n,i.event_type="xpath",i.page_url=a||decodeURIComponent(location.href),window.meteor.track(s({},i,I(n)))}},!0),document.addEventListener("beforecopy",function(t){var e=document.getSelection().toString(),n=e.length,o=t.target;if(y()&&(e=encodeURIComponent(e)),window._xpath_config&&0<n&&n<200){var r={};r.target=o,r.select_content=e,r.event_type="xpath",window.meteor.track(s({},r,I(o)))}},!0)}}(),window.meteor}();
})();;(function(){!function(){"use strict";!function(t,e){var r=t.seed=t.seed||[];if(r.start=+new Date,!r.initialize&&!r.invoked){r.invoked=!0,r.methods=["track","page","on","once","set"],r.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);return e.unshift(t),r.push(e),r}};for(var n=0;n<r.methods.length;n++){var a=r.methods[n];r[a]=r.factory(a)}r.load=function(){var t=e.createElement("script");t.type="text/javascript",t.async=!0,t.src="//s3.pstatp.com/bytecom/resource/tetris/insight/v0.1.24-beta/analytics.js";var r=e.getElementsByTagName("script")[0];r.parentNode.insertBefore(t,r)},r.SNIPPET_VERSION="1.3.2",r.load()}}(window,document)}();
})();